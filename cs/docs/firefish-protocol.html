<!doctype html>
<html lang="cs" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-firefish-protocol" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Firefish Protocol | Firefish Resources</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://anananas42.github.io/docs-Firefish/cs/img/firefish-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://anananas42.github.io/docs-Firefish/cs/img/firefish-social-card.jpg"><meta data-rh="true" property="og:url" content="https://anananas42.github.io/docs-Firefish/cs/docs/firefish-protocol"><meta data-rh="true" property="og:locale" content="cs"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="de"><meta data-rh="true" property="og:locale:alternate" content="it"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="cs"><meta data-rh="true" name="docsearch:language" content="cs"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Firefish Protocol | Firefish Resources"><meta data-rh="true" name="description" content="This document outlines the technical design of the Firefish Protocol. Please note that the actual implementation—delivered through Firefish platform—may differ in certain aspects, as both the platform and the underlying escrow system remain under active development. For the most accurate and up-to-date information on the current functionality and limitations of the Firefish Protocol, please refer to the Terms of Service."><meta data-rh="true" property="og:description" content="This document outlines the technical design of the Firefish Protocol. Please note that the actual implementation—delivered through Firefish platform—may differ in certain aspects, as both the platform and the underlying escrow system remain under active development. For the most accurate and up-to-date information on the current functionality and limitations of the Firefish Protocol, please refer to the Terms of Service."><link data-rh="true" rel="icon" href="/docs-Firefish/cs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://anananas42.github.io/docs-Firefish/cs/docs/firefish-protocol"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/docs/firefish-protocol" hreflang="en"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/es/docs/firefish-protocol" hreflang="es"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/de/docs/firefish-protocol" hreflang="de"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/it/docs/firefish-protocol" hreflang="it"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/cs/docs/firefish-protocol" hreflang="cs"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/zh/docs/firefish-protocol" hreflang="zh"><link data-rh="true" rel="alternate" href="https://anananas42.github.io/docs-Firefish/docs/firefish-protocol" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Firefish Protocol","item":"https://anananas42.github.io/docs-Firefish/cs/docs/firefish-protocol"}]}</script><link rel="stylesheet" href="/docs-Firefish/cs/assets/css/styles.df235e32.css">
<script src="/docs-Firefish/cs/assets/js/runtime~main.b510352a.js" defer="defer"></script>
<script src="/docs-Firefish/cs/assets/js/main.9cee8574.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs-Firefish/cs/img/logo512.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-Firefish/cs/"><div class="navbar__logo"><img src="/docs-Firefish/cs/img/logo512.png" alt="Firefish Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs-Firefish/cs/img/logo512.png" alt="Firefish Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Firefish Resources</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-Firefish/cs/docs/how-it-works/what-is-firefish">Knowledge Hub</a><a class="navbar__item navbar__link" href="/docs-Firefish/cs/docs/media-insights">Media &amp; Insights</a><a class="navbar__item navbar__link" href="/docs-Firefish/cs/docs/legal">Legal</a><a class="navbar__item navbar__link" href="/docs-Firefish/cs/docs/support">Podpora</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Česky</a><ul class="dropdown__menu"><li><a href="/docs-Firefish/docs/firefish-protocol" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs-Firefish/es/docs/firefish-protocol" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/docs-Firefish/de/docs/firefish-protocol" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="/docs-Firefish/it/docs/firefish-protocol" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="/docs-Firefish/cs/docs/firefish-protocol" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="cs">Česky</a></li><li><a href="/docs-Firefish/zh/docs/firefish-protocol" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">中文</a></li></ul></div><a href="https://github.com/Firefish-io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://firefish.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main Website<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-Firefish/cs/docs/how-it-works/what-is-firefish"><span title="What is Firefish?" class="linkLabel_WmDU">What is Firefish?</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs-Firefish/cs/docs/how-it-works"><span title="How it works" class="categoryLinkLabel_W154">How it works</span></a><button aria-label="Expand sidebar category &#x27;How it works&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs-Firefish/cs/docs/firefish-protocol"><span title="Firefish Protocol" class="linkLabel_WmDU">Firefish Protocol</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs-Firefish/cs/docs/faq/general"><span title="FAQ" class="categoryLinkLabel_W154">FAQ</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-Firefish/cs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Firefish Protocol</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Firefish Protocol</h1></header>
<blockquote>
<p>This document outlines the technical design of the Firefish Protocol. Please note that the actual implementation—delivered through <a href="https://app.firefish.io" target="_blank" rel="noopener noreferrer">Firefish platform</a>—may differ in certain aspects, as both the platform and the underlying escrow system remain under active development. For the most accurate and up-to-date information on the current functionality and limitations of the Firefish Protocol, please refer to the <a href="/docs-Firefish/cs/docs/legal/terms-of-service">Terms of Service</a>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="participants-in-firefish-protocol">Participants in Firefish Protocol<a href="#participants-in-firefish-protocol" class="hash-link" aria-label="Direct link to Participants in Firefish Protocol" title="Direct link to Participants in Firefish Protocol" translate="no">​</a></h2>
<ul>
<li><strong>Borrower:</strong> An individual or entity that owns bitcoin and seeks fiat or stablecoins liquidity.</li>
<li><strong>Lender:</strong> An individual or entity that has excess fiat or stablecoins liquidity and wants to earn interest.</li>
<li><strong>Liquidator:</strong> An entity entrusted by the Lender to liquidate the collateral in its name in the event that the Borrower does not fulfill its obligations. The Lender can also act as the Liquidator themselves.</li>
<li><strong>Price Oracle:</strong> An Oracle that attests to the price of bitcoin. It can be implemented as a trusted institution, a public oracle, or a threshold of institutions and public oracles. Price Oracle is currently operated by Firefish.</li>
<li><strong>Payment Oracle:</strong> An Oracle that attests to whether or not a funds transfer has been made (e.g. loan repayment). Payment Oracle is currently operated by Firefish.</li>
<li><strong>Firefish:</strong> A platform that matches Borrowers and Lenders and facilitates their secure interaction.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="loan-outcomes">Loan outcomes<a href="#loan-outcomes" class="hash-link" aria-label="Direct link to Loan outcomes" title="Direct link to Loan outcomes" translate="no">​</a></h2>
<p>Below is a table of possible outcomes of the loan including (i) outcome defintion (Description), (ii) who decides that the outcome hapenned (Trigger), and (iii) what happens to bitcoin collateral for that outcome (Result).</p>
<table><thead><tr><th style="text-align:left">Loan outcome</th><th style="text-align:left">Description</th><th style="text-align:left">Result</th><th style="text-align:left">Trigger</th></tr></thead><tbody><tr><td style="text-align:left">Repayment</td><td style="text-align:left">Loan successfully repaid</td><td style="text-align:left">All bitcoin collateral is returned to the Borrower</td><td style="text-align:left">Payment‑oracle</td></tr><tr><td style="text-align:left">Default</td><td style="text-align:left">Loan not successfully repaid</td><td style="text-align:left">Bitcoin collateral is sent to the Liquidator (distribution escrow). Part of the collateral is used to cover the amount due (either in Bitcoin for self‑managed liquidation or in loan currency for Firefish liquidation), the rest is returned back to Borrower</td><td style="text-align:left">Price‑oracle</td></tr><tr><td style="text-align:left">Liquidation</td><td style="text-align:left">Borrower’s collateral does not fully secure the loan anymore due to the decrease in its value</td><td style="text-align:left">All bitcoin collateral is sent to Lender (for self‑managed liquidation) or Liquidator (for Firefish liquidation)</td><td style="text-align:left">Price‑oracle and Payment‑oracle</td></tr><tr><td style="text-align:left">Cancellation</td><td style="text-align:left">Borrower locked bitcoin into escrow but Lender did not provide loan funds to the Borrower</td><td style="text-align:left">All bitcoin collateral is returned to the Borrower</td><td style="text-align:left">Payment‑oracle</td></tr><tr><td style="text-align:left">Disaster</td><td style="text-align:left">Oracles are not responsive</td><td style="text-align:left">Borrower can rescue all bitcoin collateral from escrow one month after the maturity date via the recovery transaction</td><td style="text-align:left">Borrower</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="escrow-contract">Escrow Contract<a href="#escrow-contract" class="hash-link" aria-label="Direct link to Escrow Contract" title="Direct link to Escrow Contract" translate="no">​</a></h2>
<p>The escrow contract is a central part of the Firefish Protocol. It allows to lock bitcoin collateral on a specific multi-signature address and specifies the rules how this collateral can be spent.</p>
<p>The first layer of the escrow contract is the escrow transaction (tx<sub>escrow</sub>). Its input is the Borrower&#x27;s bitcoin (via the Prefund transaction defined below) and its output is a 3-of-3 multisig, with keys held by:</p>
<ul>
<li>The Price Oracle</li>
<li>The Payment Oracle</li>
<li>The Borrower (Borrower&#x27;s escrow key called B-EPH)</li>
</ul>
<p>The output of the escrow transaction represents the escrow itself, and this is where the bitcoin is held during the loan.</p>
<p>The second layer of the escrow contract is represented by a set of partially signed transactions (called closing transactions) spending bitcoin collateral from the escrow output either to Lender/Liquidator or Borrower, corresponding to possible outcomes of the loan. All these transactions are presigned by the Borrower (Borrower&#x27;s escrow key B-EPH), whose private key is then discarded (that explains the name B-EPH, meaning that this key is only ephemeral). Discarding Borrower’s private key ensures that these pre-signed transactions become the only way to move the bitcoin collateral from the escrow, effectively locking all parties into the agreed-upon rules.</p>
<p>Besides being pre-signed by the Borrower, these closing transactions are pre-signed by the oracle that is not responsible for the corresponding loan outcome. Later, when some loan outcome happens, the responsible oracle confirms that by adding the last missing signature to the underlying closing transaction (making this transaction valid), and broadcasts this transaction to the bitcoin network.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="timelocks">Timelocks<a href="#timelocks" class="hash-link" aria-label="Direct link to Timelocks" title="Direct link to Timelocks" translate="no">​</a></h3>
<p>Some closing transactions use timelocks, ensuring that these transactions can only be used from a specific date in the future. Concretely,</p>
<ul>
<li>the closing transaction corresponding to Default has a timelock set to the maturity date, as a potential Default is evaluated not earlier than at the maturity date, and</li>
<li>the closing transaction corresponding to Disaster has a timelock set to one month after the maturity date, as an escrow is already spent at this time when oracles are responsive.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="summary-of-closing-transactions">Summary of closing transactions<a href="#summary-of-closing-transactions" class="hash-link" aria-label="Direct link to Summary of closing transactions" title="Direct link to Summary of closing transactions" translate="no">​</a></h3>
<p>There are at total five closing transactions:</p>
<table><thead><tr><th style="text-align:left">Loan outcome</th><th style="text-align:center">Closing transaction</th><th style="text-align:center">Missing signature</th><th style="text-align:center">Output to</th><th style="text-align:center">Timelock</th></tr></thead><tbody><tr><td style="text-align:left">Repayment</td><td style="text-align:center">tx<sub>repayment</sub></td><td style="text-align:center">Payment Oracle</td><td style="text-align:center">Borrower</td><td style="text-align:center">-</td></tr><tr><td style="text-align:left">Default</td><td style="text-align:center">tx<sub>default</sub></td><td style="text-align:center">Payment Oracle</td><td style="text-align:center">Liquidator</td><td style="text-align:center">maturity date</td></tr><tr><td style="text-align:left">Liquidation</td><td style="text-align:center">tx<sub>liquidation</sub></td><td style="text-align:center">Price Oracle, Payment Oracle</td><td style="text-align:center">Lender/Liquidator</td><td style="text-align:center">-</td></tr><tr><td style="text-align:left">Cancellation</td><td style="text-align:center">tx<sub>repayment</sub></td><td style="text-align:center">Payment Oracle</td><td style="text-align:center">Borrower</td><td style="text-align:center">-</td></tr><tr><td style="text-align:left">Disaster</td><td style="text-align:center">tx<sub>recover</sub></td><td style="text-align:center">-</td><td style="text-align:center">Borrower</td><td style="text-align:center">maturity date + 1 month</td></tr></tbody></table>
<p>The escrow contract can be schematically depicted as follows:</p>
<p><img decoding="async" loading="lazy" alt="Firefish protocol" src="/docs-Firefish/cs/assets/images/escrow-153bc25284521d507a156c929ded35fe.png" width="2667" height="1500" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prefund-contract">Prefund Contract<a href="#prefund-contract" class="hash-link" aria-label="Direct link to Prefund Contract" title="Direct link to Prefund Contract" translate="no">​</a></h2>
<p>To make it practical for Borrowers who use a variety of bitcoin infrastructure (hardware wallets, software wallets, custodial wallets), we propose using an extra on-chain transaction to consolidate and acknowledge the UTXOs that will be used to fund the escrow contract.</p>
<p>This construct makes it easy for Borrowers to interact with the Firefish protocol. First, they send their bitcoin collateral to a specific prefund address (A<sub>prefund</sub>), which allows to create the follow-up escrow and closing transactions.</p>
<p>The prefund address represents the following spending condition:</p>
<ul>
<li>3-of-3 multisig (Borrower’s prefund key, Price Oracle, Payment Oracle), or</li>
<li>Borrower’s prefund key and a relative timelock of 7 days.</li>
</ul>
<p>The first spending condition using the multisig is used to move bitcoin from prefund to escrow when all parties cooperate.
The second spending condition using only Borrower’s prefund key with a relative timelock works as a safeguard for the Borrower, should oracles become unresponsive or malicious during the contract setup.</p>
<p>Once the Bitcoin is locked into prefund, all information is known to create the escrow and closing transactions.</p>
<p>The whole Firefish protocol, including prefund, escrow and closing transactions, can be schematically depicted as follows:</p>
<p><img decoding="async" loading="lazy" alt="Firefish protocol" src="/docs-Firefish/cs/assets/images/prefund_and_escrow-ebbe69fadc8ef08963e413204e39c5b3.png" width="2667" height="1500" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-implementation">Protocol Implementation<a href="#protocol-implementation" class="hash-link" aria-label="Direct link to Protocol Implementation" title="Direct link to Protocol Implementation" translate="no">​</a></h2>
<p>The whole Firefish protocol is implemented in Rust. To simplify the interaction with the protocol for Borrowers, the Borrower&#x27;s part, called borrower-client, is compiled into WASM and runs at <a href="https://app.firefish.io" target="_blank" rel="noopener noreferrer">Firefish platform</a>. The source code for the borrower-client is available <a href="https://protocol.firefish.io" target="_blank" rel="noopener noreferrer">here</a>. It also contains instructions for deterministic builds, allowing Borrowers to verify that the client used at Firefish platform corresponds to the published source code.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-process">The Process<a href="#the-process" class="hash-link" aria-label="Direct link to The Process" title="Direct link to The Process" translate="no">​</a></h2>
<p>Below you can find the simplified process of the escrow setup and the lifetime of the loan.</p>
<ol>
<li>The participants in the protocol securely exchange necessary data (such as loan details) and public keys, everything via the Firefish platform.</li>
<li>Borrower enters his return address where bitcoin collateral will be returned upon successful repayment.</li>
<li>Using the borrower-client, the Borrower generates the prefund address.</li>
<li>The Borrower sends bitcoin collateral to the prefund address using their own wallet.</li>
<li>Using the borrower-client, the Borrower constructs the escrow and closing transactions, and adds their own signatures to the closing transactions.</li>
<li>The oracles add their own signatures to the escrow transaction and the closing transactions according to the protocol specification.</li>
<li>Using the borrower-client, the Borrower verifies that all transactions and signatures are in place. After verification, Borrower adds the last missing signature to the escrow transaction.</li>
<li>Using the borrower-client, the Borrower discards their escrow private key, ensuring that the spending options for the escrow are limited to those defined by the closing transactions.</li>
<li>Borrower broadcasts the now fully signed escrow transaction, effectively locking bitcoin collateral. The escrow is properly set.</li>
<li>Lender sends funds (fiat or stablecoins) to the Borrower.</li>
<li>Later, when the loan outcome is known (repayment, default, …), the corresponding transaction is signed and broadcast by the responsible oracle for the given outcome, effectively closing the loan.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-benefits-of-firefish-protocol">Key Benefits of Firefish Protocol<a href="#key-benefits-of-firefish-protocol" class="hash-link" aria-label="Direct link to Key Benefits of Firefish Protocol" title="Direct link to Key Benefits of Firefish Protocol" translate="no">​</a></h2>
<ul>
<li>The escrow has a &quot;deterministic&quot; nature. It can only be spent on the Borrower&#x27;s or Lender’s/Liquidator&#x27;s address, but not to any other subject.</li>
<li>The Lender does not need to possess any cryptographic material or otherwise interact with the Bitcoin network. This allows entities that are not Bitcoin-native to invest on the Firefish platform.</li>
<li>The Borrower only needs to be online and interact with the platform during the escrow setup phase. Afterwards, this is no longer necessary - they do not need to sign anything else or keep the keys online.</li>
<li>If the Oracles stop cooperating during any phase of the loan, the Borrower can spend the Bitcoin on their own address after the timelock expires.</li>
<li>The interaction of the Borrower with the protocol is reduced to (i) provide your return address and (ii) send bitcoin to the prefund address. The whole complexity, such as creating the addresses and signing the escrow and closing transactions, is processed by the borrower-client.</li>
<li>Since the interaction is so simple, Firefish can be used by hardware wallet owners as well as Multi-Party Computation (MPC) wallets (institutions) or even custodial solutions (which is indeed not recommended).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="potential-drawbacks-of-firefish-protocol">Potential Drawbacks of Firefish Protocol<a href="#potential-drawbacks-of-firefish-protocol" class="hash-link" aria-label="Direct link to Potential Drawbacks of Firefish Protocol" title="Direct link to Potential Drawbacks of Firefish Protocol" translate="no">​</a></h2>
<ul>
<li>As with any other bitcoin-backed lending protocol, some level of trust is required in the oracles being honest. However, we believe that this need for trust can be minimized at the implementation level (for example, decentralizing the Price-oracle, using DLCs, anonymization techniques used by the Payment-oracle, etc.).</li>
<li>The contract cannot be canceled without the cooperation of the oracle entities, even if the Lender and Borrower agree.</li>
<li>The complexity of the proposed solution and the fact that the security and business advantages may not be immediately apparent.</li>
<li>The Lender (and Borrower) must have some level of trust in the Liquidator that they will return the funds/bitcoin in the case of liquidation and default. This can be minimized, for example, by the Liquidator providing some form of security or using DLCs.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Anananas42/docs-Firefish/tree/main/docs/firefish-protocol.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-Firefish/cs/docs/how-it-works/loan-actions-menu"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Loan Actions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-Firefish/cs/docs/faq/general"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">General</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#participants-in-firefish-protocol" class="table-of-contents__link toc-highlight">Participants in Firefish Protocol</a></li><li><a href="#loan-outcomes" class="table-of-contents__link toc-highlight">Loan outcomes</a></li><li><a href="#escrow-contract" class="table-of-contents__link toc-highlight">Escrow Contract</a><ul><li><a href="#timelocks" class="table-of-contents__link toc-highlight">Timelocks</a></li><li><a href="#summary-of-closing-transactions" class="table-of-contents__link toc-highlight">Summary of closing transactions</a></li></ul></li><li><a href="#prefund-contract" class="table-of-contents__link toc-highlight">Prefund Contract</a></li><li><a href="#protocol-implementation" class="table-of-contents__link toc-highlight">Protocol Implementation</a></li><li><a href="#the-process" class="table-of-contents__link toc-highlight">The Process</a></li><li><a href="#key-benefits-of-firefish-protocol" class="table-of-contents__link toc-highlight">Key Benefits of Firefish Protocol</a></li><li><a href="#potential-drawbacks-of-firefish-protocol" class="table-of-contents__link toc-highlight">Potential Drawbacks of Firefish Protocol</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs-Firefish/cs/docs/how-it-works">How it works</a></li><li class="footer__item"><a class="footer__link-item" href="/docs-Firefish/cs/docs/faq/general">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs-Firefish/cs/docs/firefish-protocol">Firefish Protocol</a></li><li class="footer__item"><a class="footer__link-item" href="/docs-Firefish/cs/docs/support">Podpora</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/7dbKKaQxH3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://firefish.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main Website<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs-Firefish/cs/docs/legal">Legal Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs-Firefish/cs/docs/media-insights">Media &amp; Insights</a></li><li class="footer__item"><a href="https://github.com/Firefish-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Firefish.</div></div></div></footer></div>
</body>
</html>